<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Email Manager</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container { max-width: 1000px; margin: 0 auto; }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .card h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }
        
        input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .result {
            display: none;
            margin-top: 20px;
        }
        
        .priority-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .priority-high {
            background: #fee;
            color: #c33;
            border: 2px solid #c33;
        }
        
        .priority-medium {
            background: #fef3cd;
            color: #856404;
            border: 2px solid #856404;
        }
        
        .priority-low {
            background: #d4edda;
            color: #155724;
            border: 2px solid #155724;
        }
        
        .response-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            margin-top: 15px;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }
        
        .btn-secondary:hover {
            background: #f8f9fa;
        }
        
        .knowledge-base {
            margin-top: 15px;
        }
        
        .kb-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 3px solid #667eea;
        }
        
        .kb-item strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
        }
        
        .add-kb-btn {
            background: white;
            color: #667eea;
            border: 2px dashed #667eea;
            margin-top: 10px;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
        }
        
        .info-box {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        
        .info-box p {
            color: #0c5460;
            margin-bottom: 5px;
        }
        
        .tag {
            display: inline-block;
            background: #e0e7ff;
            color: #667eea;
            padding: 4px 12px;
            border-radius: 15px;
            margin: 4px;
            font-size: 13px;
        }
        
        .score-details {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }
        
        .score-item {
            padding: 5px 0;
            color: #555;
        }
        
        .score-item strong {
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ AI Email Manager</h1>
            <p>Smart email prioritization and auto-response suggestions</p>
        </div>

        <div class="card">
            <h2>‚öôÔ∏è Your Settings</h2>
            <div class="input-group">
                <label>Your Interests/Priorities (comma separated)</label>
                <input type="text" id="interests" placeholder="e.g., Product launches, Customer feedback, Partnership opportunities">
            </div>
            
            <div class="input-group">
                <label>Your Schedule/Availability</label>
                <input type="text" id="schedule" placeholder="e.g., Available Mon-Fri 9am-5pm EST, Busy with meetings Wednesdays">
            </div>
        </div>

        <div class="card">
            <h2>üìß Analyze Email</h2>
            <div class="input-group">
                <label>Email Subject</label>
                <input type="text" id="emailSubject" placeholder="Enter email subject">
            </div>
            
            <div class="input-group">
                <label>Email Content</label>
                <textarea id="emailContent" placeholder="Paste the email content here..."></textarea>
            </div>
            
            <button class="btn" onclick="analyzeEmail()">Analyze Email</button>
            
            <div id="result" class="result">
                <h3>üìä Analysis Result</h3>
                <div id="priorityBadge"></div>
                <div id="scoreDetails" class="score-details"></div>
                <div id="analysis"></div>
                <div class="response-box">
                    <strong>üí° Suggested Response:</strong>
                    <div id="suggestedResponse"></div>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="editResponse()">‚úèÔ∏è Edit Response</button>
                    <button class="btn" onclick="approveResponse()">‚úÖ Approve & Copy</button>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>üß† Knowledge Base (Your Answer Library)</h2>
            <div class="info-box">
                <p><strong>üí° How it works:</strong> Add common questions and your standard answers. The AI will use these to suggest responses automatically.</p>
            </div>
            <div id="knowledgeBase" class="knowledge-base">
                <div class="kb-item">
                    <strong>Q: What are your working hours?</strong>
                    <p>I'm available Monday through Friday, 9 AM to 5 PM EST. For urgent matters outside these hours, please mark your email as "urgent".</p>
                </div>
                <div class="kb-item">
                    <strong>Q: Do you offer refunds?</strong>
                    <p>Yes, we offer a 30-day money-back guarantee on all our products. Simply reply to this email with your order number to initiate a refund.</p>
                </div>
            </div>
            <button class="btn add-kb-btn" onclick="addKnowledgeBase()">+ Add New Q&A</button>
        </div>
    </div>

    <script>
        let knowledgeBase = [
            {
                question: "What are your working hours?",
                answer: "I'm available Monday through Friday, 9 AM to 5 PM EST. For urgent matters outside these hours, please mark your email as 'urgent'."
            },
            {
                question: "Do you offer refunds?",
                answer: "Yes, we offer a 30-day money-back guarantee on all our products. Simply reply to this email with your order number to initiate a refund."
            }
        ];

        function analyzeEmail() {
            const interests = document.getElementById('interests').value;
            const schedule = document.getElementById('schedule').value;
            const subject = document.getElementById('emailSubject').value;
            const content = document.getElementById('emailContent').value;

            if (!subject || !content) {
                alert('Please enter both email subject and content');
                return;
            }

            document.getElementById('result').style.display = 'block';
            document.getElementById('result').innerHTML = '<div class="loading">ü§ñ AI is analyzing your email...</div>';

            setTimeout(() => {
                const analysis = performAnalysis(subject, content, interests, schedule);
                displayResults(analysis);
            }, 1500);
        }

        function performAnalysis(subject, content, interests, schedule) {
            const fullText = (subject + ' ' + content).toLowerCase();
            let score = 0;
            let scoreBreakdown = [];

            // CRITICAL/URGENT KEYWORDS (High Priority) - 4 points each
            const criticalWords = ['urgent', 'asap', 'critical', 'emergency', 'immediate', 'deadline today', 'time-sensitive', 'expires', 'last chance'];
            criticalWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 4;
                    scoreBreakdown.push(`+4: Critical keyword "${word}" detected`);
                }
            });

            // IMPORTANT KEYWORDS - 3 points each
            const importantWords = ['important', 'priority', 'deadline', 'due', 'required', 'must', 'action needed', 'response needed'];
            importantWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 3;
                    scoreBreakdown.push(`+3: Important keyword "${word}" found`);
                }
            });

            // BUSINESS OPPORTUNITY KEYWORDS - 3 points each
            const opportunityWords = ['partnership', 'investment', 'investor', 'funding', 'revenue', 'opportunity', 'collaboration', 'deal', 'contract'];
            opportunityWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 3;
                    scoreBreakdown.push(`+3: Business opportunity keyword "${word}"`);
                }
            });

            // CUSTOMER/CLIENT KEYWORDS - 3 points each
            const customerWords = ['customer', 'client', 'feedback', 'complaint', 'issue', 'problem', 'bug', 'not working', 'error'];
            customerWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 3;
                    scoreBreakdown.push(`+3: Customer-related keyword "${word}"`);
                }
            });

            // MEDIA/PRESS KEYWORDS - 3 points each
            const mediaWords = ['interview', 'press', 'media', 'article', 'feature', 'journalist', 'reporter', 'publication'];
            mediaWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 3;
                    scoreBreakdown.push(`+3: Media opportunity "${word}"`);
                }
            });

            // SECURITY KEYWORDS - 5 points (highest priority)
            const securityWords = ['security', 'breach', 'hacked', 'suspicious activity', 'unauthorized', 'alert', 'password'];
            securityWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 5;
                    scoreBreakdown.push(`+5: SECURITY ALERT "${word}"`);
                }
            });

            // MEETING/CALL KEYWORDS - 2 points
            const meetingWords = ['meeting', 'call', 'zoom', 'conference', 'schedule', 'available'];
            meetingWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 2;
                    scoreBreakdown.push(`+2: Meeting/call related "${word}"`);
                }
            });

            // Check interests match - 4 points per match
            if (interests) {
                const interestList = interests.toLowerCase().split(',');
                interestList.forEach(interest => {
                    if (fullText.includes(interest.trim())) {
                        score += 4;
                        scoreBreakdown.push(`+4: Matches your interest "${interest.trim()}"`);
                    }
                });
            }

            // Check for time indicators
            const timeWords = ['today', 'tomorrow', 'this week', 'end of week', 'by friday', 'by monday'];
            timeWords.forEach(word => {
                if (fullText.includes(word)) {
                    score += 2;
                    scoreBreakdown.push(`+2: Time-sensitive indicator "${word}"`);
                }
            });

            // Determine priority - IMPROVED THRESHOLDS
            let priority = 'low';
            if (score >= 8) priority = 'high';      // Lowered from 5 to 8 for more accuracy
            else if (score >= 4) priority = 'medium'; // Lowered from 2 to 4

            let suggestedResponse = generateResponse(content, subject, fullText);

            return {
                priority: priority,
                score: score,
                scoreBreakdown: scoreBreakdown,
                reasoning: generateReasoning(priority, score, interests, scoreBreakdown),
                suggestedResponse: suggestedResponse
            };
        }

        function generateReasoning(priority, score, interests, breakdown) {
            let reasons = [];
            
            if (priority === 'high') {
                reasons.push('üî¥ HIGH PRIORITY - Requires immediate attention');
                reasons.push(`Score: ${score} points (8+ = High Priority)`);
            } else if (priority === 'medium') {
                reasons.push('üü° MEDIUM PRIORITY - Review within 24 hours');
                reasons.push(`Score: ${score} points (4-7 = Medium Priority)`);
            } else {
                reasons.push('üü¢ LOW PRIORITY - Can be reviewed when convenient');
                reasons.push(`Score: ${score} points (0-3 = Low Priority)`);
            }
            
            return reasons.join(' ‚Ä¢ ');
        }

        function generateResponse(content, subject, fullText) {
            // Check knowledge base for matching questions
            for (let kb of knowledgeBase) {
                const questionWords = kb.question.toLowerCase().split(' ');
                let matchCount = 0;
                
                questionWords.forEach(word => {
                    if (word.length > 3 && fullText.includes(word)) {
                        matchCount++;
                    }
                });
                
                if (matchCount / questionWords.length > 0.4) {
                    return kb.answer;
                }
            }
            
            // Generate contextual response based on email type
            if (fullText.includes('partnership') || fullText.includes('collaboration')) {
                return `Thank you for reaching out regarding "${subject}". I'm very interested in exploring partnership opportunities. I'd be happy to schedule a call to discuss this further. Could you please share some available times that work for you?\n\nLooking forward to connecting!\n\nBest regards`;
            }
            
            if (fullText.includes('investment') || fullText.includes('investor') || fullText.includes('funding')) {
                return `Thank you for your interest in our product! I'd be delighted to discuss potential investment opportunities. I can provide you with our pitch deck, current metrics, and roadmap. \n\nWould you be available for a call this week? Please let me know what times work best for you.\n\nBest regards`;
            }
            
            if (fullText.includes('interview') || fullText.includes('press') || fullText.includes('media')) {
                return `Thank you for considering us for your feature! I'd be honored to participate in the interview. I'm available this week and can accommodate your schedule.\n\nPlease send over the questions or topics you'd like to cover, and we can coordinate a time.\n\nBest regards`;
            }
            
            if (fullText.includes('customer') || fullText.includes('issue') || fullText.includes('problem') || fullText.includes('bug')) {
                return `Thank you for bringing this to my attention. I sincerely apologize for the inconvenience you're experiencing. \n\nI'm looking into this issue right away and will have a solution for you within 24 hours. Your feedback helps us improve our service.\n\nI'll follow up shortly with an update.\n\nBest regards`;
            }
            
            if (fullText.includes('security') || fullText.includes('suspicious') || fullText.includes('breach')) {
                return `URGENT: Thank you for the security alert. I'm taking immediate action to secure the account:\n\n1. Changing password now\n2. Enabling two-factor authentication\n3. Reviewing recent activity\n\nI'll respond with confirmation once all security measures are in place.\n\nThank you for the prompt notification.`;
            }
            
            // Default response
            return `Thank you for reaching out regarding "${subject}". I've received your email and will review it carefully. Based on my current schedule and priorities, I'll get back to you with a detailed response soon.\n\nBest regards`;
        }

        function displayResults(analysis) {
            const priorityClass = `priority-${analysis.priority}`;
            const priorityText = analysis.priority.toUpperCase();
            
            let scoreDetailsHTML = '<strong>üìà Score Breakdown:</strong><br>';
            if (analysis.scoreBreakdown.length > 0) {
                analysis.scoreBreakdown.forEach(item => {
                    scoreDetailsHTML += `<div class="score-item">${item}</div>`;
                });
            } else {
                scoreDetailsHTML += '<div class="score-item">No priority indicators found</div>';
            }
            scoreDetailsHTML += `<div class="score-item"><strong>Total Score: ${analysis.score} points</strong></div>`;
            
            document.getElementById('result').innerHTML = `
                <h3>üìä Analysis Result</h3>
                <div class="priority-badge ${priorityClass}">
                    ${priorityText} PRIORITY (Score: ${analysis.score})
                </div>
                <div id="scoreDetails" class="score-details">${scoreDetailsHTML}</div>
                <p><strong>Assessment:</strong> ${analysis.reasoning}</p>
                <div class="response-box">
                    <strong>üí° Suggested Response:</strong>
                    <div id="suggestedResponse" style="margin-top: 10px; white-space: pre-wrap;">${analysis.suggestedResponse}</div>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="editResponse()">‚úèÔ∏è Edit Response</button>
                    <button class="btn" onclick="approveResponse()">‚úÖ Approve & Copy</button>
                </div>
            `;
            
            document.getElementById('result').style.display = 'block';
        }

        function editResponse() {
            const responseDiv = document.getElementById('suggestedResponse');
            const currentText = responseDiv.textContent;
            
            responseDiv.innerHTML = `<textarea style="width: 100%; min-height: 120px; padding: 10px; border: 2px solid #667eea; border-radius: 8px;">${currentText}</textarea>
            <button class="btn" style="margin-top: 10px;" onclick="saveEdit()">üíæ Save Changes</button>`;
        }

        function saveEdit() {
            const textarea = document.querySelector('#suggestedResponse textarea');
            const newText = textarea.value;
            document.getElementById('suggestedResponse').innerHTML = newText;
            alert('‚úÖ Response updated!');
        }

        function approveResponse() {
            const response = document.getElementById('suggestedResponse').textContent;
            
            navigator.clipboard.writeText(response).then(() => {
                alert('‚úÖ Response copied to clipboard! You can now paste it into your email.');
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = response;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('‚úÖ Response copied to clipboard!');
            });
        }

        function addKnowledgeBase() {
            const question = prompt('Enter the common question:');
            if (!question) return;
            
            const answer = prompt('Enter your standard answer:');
            if (!answer) return;
            
            knowledgeBase.push({ question, answer });
            
            const kbDiv = document.getElementById('knowledgeBase');
            const newItem = document.createElement('div');
            newItem.className = 'kb-item';
            newItem.innerHTML = `
                <strong>Q: ${question}</strong>
                <p>${answer}</p>
            `;
            kbDiv.appendChild(newItem);
            
            alert('‚úÖ Knowledge base updated!');
        }

        window.onload = function() {
            document.getElementById('interests').value = 'Product launches, Customer feedback, Partnership opportunities';
            document.getElementById('schedule').value = 'Available Mon-Fri 9am-5pm EST';
        }
    </script>
</body>
</html>
